"use strict";var React=require("../../lib/react.js"),cssStr=require("../../cssStr/cssStr.js"),LoginLayerview=require("./LoginLayerview.js"),windowStore=require("../../stroes/windowStores.js"),windowActions=require("../../actions/windowActions.js"),webviewStores=require("../../stroes/webviewStores.js"),mouserTimer,Logindisplay=React.createClass({displayName:"Logindisplay",getInitialState:function(){var e=windowStore.getUserInfo(),t=!e;return{loginStatus:!!e,headUrl:e?e.headUrl:"",nickName:e?e.nickName:"",showLoginLayer:t,showProp:!1}},componentDidMount:function(){var e=this;windowStore.on("UPDATA_USER_INFO",function(t){e.setState({loginStatus:!!t,headUrl:t?t.headUrl:"",nickName:t?t.nickName:"",showLoginLayer:!1,showProp:!1})}),windowStore.on("SHOW_ABOUT_LAYER",function(){e.setState({showLoginLayer:!1})}),windowStore.on("SHOW_LOGIN_LAYER",function(){e.setState({showLoginLayer:!0})}),webviewStores.on("NOT_LOGIN",function(){e.setState({showLoginLayer:!0})}),webviewStores.on("INVALID_LOGIN",function(){windowActions.showTipsMsg("请重新登录"),windowActions.clearUserInfo(),e.setState({showLoginLayer:!0})})},handleOnClick:function(e){var t=e.currentTarget,s=t.dataset,o=s.type;"login"===o?this.setState({showLoginLayer:!0}):windowActions.clearUserInfo()},closeLoginLayer:function(){this.setState({showLoginLayer:!1})},handleOnMouseover:function(e){var t=this;this.state.loginStatus&&!this.state.showLoginLayer&&(clearTimeout(mouserTimer),mouserTimer=setTimeout(function(){t.state.showProp=!0,t.setState(t.state)},50))},handleOnMouseout:function(e){var t=this;this.state.loginStatus&&!this.state.showLoginLayer&&(clearTimeout(mouserTimer),mouserTimer=setTimeout(function(){t.state.showProp=!1,t.setState(t.state)},50))},render:function(){return React.createElement("div",{className:"header-content_login",onMouseLeave:this.handleOnMouseout,onMouseEnter:this.handleOnMouseover},React.createElement("div",{style:this.state.showProp?{}:cssStr.displayNone,className:"container-popover container-popover_login"},React.createElement("div",{className:"container-popover_pic"},React.createElement("img",{src:this.state.headUrl}),React.createElement("p",{className:"container-popover_name"},this.state.nickName)),React.createElement("div",{className:"btn-wrap"},React.createElement("span",{onClick:this.handleOnClick,"data-type":"logout",className:"btn btn_default"},"退出"))),React.createElement("img",{style:this.state.loginStatus?{}:cssStr.displayNone,width:"34",height:"34",src:this.state.headUrl}),React.createElement("span",{style:this.state.loginStatus?{}:cssStr.displayNone,className:"header-content_state_logout"},"退出"),React.createElement("span",{onClick:this.handleOnClick,"data-type":"login",style:this.state.loginStatus?cssStr.displayNone:{},className:"header-content_state_in"},"登录"),React.createElement(LoginLayerview,{closeLoginLayer:this.closeLoginLayer,showLoginLayer:this.state.showLoginLayer}))}});module.exports=Logindisplay;