"use strict";var React=require("../../lib/react.js"),cssStr=require("../../cssStr/cssStr.js"),log=require("../../common/log/log.js"),webviewStores=require("../../stroes/webviewStores.js"),timer=void 0,loadingTimer=void 0,Loading=React.createClass({displayName:"Loading",getInitialState:function(){return{webviewID:parseInt(this.props.webviewID),rate:-100,backgroundColor:{}}},_upWebviewStatus:function(e,t){var s=this,i=t.loading;if("start"===i){clearTimeout(timer);var a=parseInt(100*Math.random());this.state.rate=a,this.setState(this.state),loadingTimer=setTimeout(function(){s.state.rate<50&&(s.state.rate+=5),s.state.rate<75&&(s.state.rate+=2),s.state.rate<90&&(s.state.rate+=1),s.setState(s.state)},200)}else"stop"===i&&(clearTimeout(timer),clearTimeout(loadingTimer),this.state.rate=100,this.setState(this.state),timer=setTimeout(function(){s.state.rate=0,s.setState(s.state)},200))},_setInterfaceRes:function(e,t,s,i){if(s){log.info("WebviewLoading.js SET_INTERFACE_RES webviewID:"+e+" "+t);var a=i.args;if("setNavigationBarColor"===t){var r=a.color;this.setState({backgroundColor:{backgroundColor:r}})}}},_getA8keyDone:function(e){log.info("WebviewLoading.js GETA_8KEY_DONE webviewID:"+e),this.setState({backgroundColor:{}})},componentDidMount:function(){webviewStores.on("UP_WEBVIEW_STATUS_"+this.state.webviewID,this._upWebviewStatus),webviewStores.on("SET_INTERFACE_RES_"+this.state.webviewID,this._setInterfaceRes),webviewStores.on("GETA_8KEY_DONE_"+this.state.webviewID,this._getA8keyDone)},componentWillUnmount:function(){webviewStores.removeListener("UP_WEBVIEW_STATUS_"+this.state.webviewID,this._upWebviewStatus),webviewStores.removeListener("SET_INTERFACE_RES_"+this.state.webviewID,this._setInterfaceRes),webviewStores.removeListener("GETA_8KEY_DONE_"+this.state.webviewID,this._getA8keyDone)},render:function(){var e={width:this.state.rate+"%"};return e=0===this.state.rate?Object.assign(e,cssStr.displayNone):Object.assign(e,cssStr.displayBlock),React.createElement("div",{className:"progress_outer",style:this.state.backgroundColor},React.createElement("div",{style:e,className:"progress_inner"}))}});module.exports=Loading;