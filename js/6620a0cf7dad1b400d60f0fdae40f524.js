'use strict';var _extends=Object.assign||function(a){for(var b,c=1;c<arguments.length;c++)for(var d in b=arguments[c],b)Object.prototype.hasOwnProperty.call(b,d)&&(a[d]=b[d]);return a};!function(require,directRequire){const a=require('react'),b=require('./libs/react-dom/index.js'),{Provider:c}=require('react-redux'),d=directRequire('./bc78839ccca8df9e5ceeb7fae11b7be2.js'),e=require('./db2217eb4cff896bdcbc50abe005058f.js'),f=require('./56c390e04c10e91a4aa2a2c19d9a885d.js');class g extends a.Component{constructor(a){super(a),this.state={mount:!0}}render(){return this.state.mount?a.createElement('div',{className:this.props.className},this.props.children):a.createElement('div',null)}}module.exports=class extends a.Component{constructor(a){super(a),this.queue=[]}componentDidMount(){nw.Window.open(this.props.templateHTML||'html/popup.html',this.getWindowOptions(),(f)=>{if(this.unmounted)return void f.close(!0);this.registryId=this.props.registryId,this.child=f,f.on('close',()=>{this.props.onWindowClose&&this.props.onWindowClose(),this.child&&(this.child.window.onWindowClose&&this.child.window.onWindoClose(),this.closeWindow())});const h=global.Win.window,i=f.window;i.parent=h;const j=document.createElement('body'),k=document.createElement('div');if(k.style.cssText='width: 100%; height: 100%;',this.props.className&&(k.className=this.props.className),j.appendChild(k),i.document.body=j,this.props.children)b.render(a.createElement(c,{store:d},a.createElement(g,{ref:(a)=>this.dummy=a},this.props.children)),k,()=>{this.registryId&&e.register({id:this.registryId,window:f})});else{const h=this.props.renderClass,i=this.props.renderProps||{};b.render(a.createElement(c,{store:d},a.createElement(g,{ref:(a)=>this.dummy=a},a.createElement(h,_extends({},i,{win:f})))),k,()=>{this.registryId&&e.register({id:this.registryId,window:f})})}})}componentWillUnmount(){this.unmounted=!0,this.closeWindow()}closeWindow(){this.registryId&&e.unregister(this.registryId);const a=()=>{try{this.child.close(!0),this.child=null}catch(a){}};if(this.dummy)try{this.dummy.setState({mount:!1},()=>{a()})}catch(b){a()}else this.child&&a()}appendChild(a){if(a&&this.queue.push(a),!this.child)return;const b=this.child.window;this.queue.forEach((a)=>{console.log(2),b.document.body.appendChild(a)}),this.queue=[]}getWindowOptions(){return function(a){const b={};for(let c of a)this.props.hasOwnProperty(c)&&(b[c]=this.props[c]);return b.title||(b.title='\u5FAE\u4FE1 web \u5F00\u53D1\u8005\u5DE5\u5177'),b.width||(b.width=f.SIZE.DEFAULT.WIDTH),b.height||(b.height=f.SIZE.DEFAULT.HEIGHT),b.hasOwnProperty('focus')||(b.focus=!0),b}.bind(this)(['id','title','icon','position','focus','always_on_top','width','height','min_width','min_height','max_width','max_height','resizable','kiosk','fullscreen','show_in_taskbar','frame','transparent'])}render(){return a.createElement('div',{style:{display:'none'}})}}}(require('lazyload'),require);