'use strict';!function(require,directRequire){const a=require('./233d77ecf0781f44985f684f70e316d0.js'),b=require('./89ba85d67a88f7636d657c22b5d3e038.js'),c=require('./df6d0ff021a69fb541c733de4dbba0fe.js'),d=require('./9c906d27ca74e18d0deaaa231e71fdfa.js'),e=require('./bc78839ccca8df9e5ceeb7fae11b7be2.js'),f=require('./3bfffbe88b3d923921f851c0697974fe.js'),g=require('./d3976cc01aeebc5b09e11c4135b6bd8d.js'),h=require('./f171257bbcaef547a3cf27266ccb0db2.js'),i=require('./common/locales/index.js'),{NOT_LOGIN:j,INVALID_TOKEN:k,INVALID_LOGIN:l,DEV_NEED_RELOGIN:m,DEV_INVALID_SIGNATURE:n}=c,o='darwin'===process.platform?'darwin':'win',p=(a)=>{let{needAppID:b,needRandom:c,needSystemInfo:d}=a;delete a.needAppID,delete a.needRandom;let e=(a.url||'').split('?'),g=e[0],h=[];return-1!==c&&h.push(`_r=${Math.random()}`),1===b&&h.push(`${f.formatAppIDQuery()}`),-1!==d&&h.push(`os=${o}&clientversion=${'018182600'}`),e[1]&&h.push(e[1]),a.url=`${g}?${h.join('&')}`,a},q=(a)=>{return a===j||a===l||a===k||a===m||a===n?(e.dispatch(d.loginExpired()),!0):void 0};module.exports=async function(c){let{needToken:d,needParse:e,needCheckErrCode:f,forceLogin:h}=c;if(delete c.needToken,delete c.needParse,delete c.needCheckErrCode,1===d)try{c=await b.makeRequestOptionsWithLoginState(c)}catch(a){if(1===d&&-1!=h)throw q(a),i.config.CGI_ERR_NEED_RELOGIN;else;}return c=p(c),new Promise((b,i)=>{a(c,(a,c,j)=>{if(a&&i(a),-1===e)return b({resp:c,body:j});try{let a=JSON.parse(j);if(-1!==f){let b=a.baseresponse||{},c=b.errcode;if(void 0!==c&&0!==c)return 1===d&&-1!=h&&q(c),i(g.parseCgiErrorCode(c,b.errmsg))}b({resp:c,body:a})}catch(a){i(a)}})})}}(require('lazyload'),require);